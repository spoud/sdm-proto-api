syntax = "proto3";
package io.spoud.sdm.logistics.selection.v1;

option java_multiple_files = true;
option java_package = "io.spoud.sdm.logistics.selection.v1";
option go_package = "selection.v1";

// TransportMatchingProperties are used to define an internal business key, which
// can be used for referencing a resource across different components.
message TransportMatchingProperties {
  BaseRef transport = 5;
  map<string, string> properties = 1;
}

// DataOffer reference.
message DataOfferRef {
  oneof ref {
    // ref by id or name
    IdNameRef id_name = 5;

    // provide matching properties explicitly
    // MatchingProperties properties = 3

    // Deprecated, please use data_port
    // ref by state (e.g. DataOfferState, DataSubscriptionState)
    DataOfferStateRef data_offer_state = 4 [deprecated=true];

    // ref by data port
    DataPortRef data_port = 6;


    // referencing properties of outer (relative) resource object.
    // not yet supported
    // google.protobuf.FieldMask property_mask =  7;
  }

  // reserved for self matching properties
  reserved 3;
}

// DataSubscription reference.
message DataSubscriptionRef {
  // ref by id or name
  IdNameRef id_name = 1;
}

// Deprecated since 29.10.2020, please use @DataPortRef
// DataOfferState reference.
message DataOfferStateRef {
  option deprecated = true;
  oneof ref {

    // ref by id or name
    IdNameRef id_name = 4;

    // provide matching properties explicitly
    TransportMatchingProperties transport_matching_properties = 3;

    // referencing properties of outer (relative) resource object.
    // not yet supported
    // google.protobuf.FieldMask property_mask =  4;
  }
}

// DataPort reference.
message DataPortRef {
  option deprecated = true;
  oneof ref {

    // ref by id or name
    IdNameRef id_name = 4;

    // provide matching properties explicitly
    TransportMatchingProperties transport_matching_properties = 3;

    // referencing properties of outer (relative) resource object.
    // not yet supported
    // google.protobuf.FieldMask property_mask =  4;
  }
}

message DataSubscriptionStateRef {
  oneof ref {

    // ref by id or name
    IdNameRef id_name = 4;

    // provide matching properties explicitly
    TransportMatchingProperties transport_matching_properties = 3;

    // referencing properties of outer (relative) resource object.
    // not yet supported
    // google.protobuf.FieldMask property_mask =  4;
  }
}

message IdNameRef {
  oneof ref {
    // ref by id
    string id = 1;
    // ref by name;
    string name = 2;
    // deprecated since 2020-08-10 use reference with id or name (field 1 and  2) instead.
    // ref by either
    string id_or_name = 4 [deprecated=true];
  }
  reserved 3;
}

message IdPathRef {
  oneof ref {
    // ref by id
    string id = 1;
    // ref by path;
    string path = 3;
  }
}

// Base ref type.
// Used for any resource ref without a specific ref message.
// Support ref evolution by moving from this basic ref type to a dedicated ref messages.
message BaseRef {
  IdNameRef id_name = 1;
}

message ResourceGroupRef {
  oneof ref {
    // deprecated since 2020-08-10 use reference with id_path (field 2) instead.
    IdNameRef id_name = 1 [deprecated=true];
    IdPathRef id_path = 2;
  }
}
